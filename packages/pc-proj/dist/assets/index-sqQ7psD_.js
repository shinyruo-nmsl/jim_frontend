import{j as e,b0 as m,C as h,r as n,b1 as g,I as f,s as j,W as b}from"./index-64wCEMT-.js";import{u as v}from"./aiTextGener-a3QDKtBZ.js";import{W as I}from"./index-DlVgwk1V.js";import{W as y}from"./index-EgsoIQEg.js";import{S as A}from"./index-Bqk1BXhs.js";import{D as N}from"./index-C-cSi9pZ.js";const{MarkdownText:P}=y;function S({content:s}){return e.jsxs("div",{className:"chat-message user",children:[e.jsx("div",{className:"dialog",children:s}),e.jsx(m,{})]})}function W({content:s}){return e.jsxs("div",{className:"chat-message assistant",children:[e.jsx(h,{characterName:"A"}),s.length>0?e.jsx(P,{content:s,hlStyle:{borderRadius:"5px",padding:"10px",margin:"10px 0",overflowX:"auto"},iconStyle:{top:"5px",right:"5px",cursor:"pointer",width:"25px",height:"25px"}}):e.jsx("div",{className:"w-fit max-w-[800px] bg-[azure] border border-solid border-[blue] rounded-[5px] p-[12px] text-[12px]/[16px] break-all",children:e.jsx(A,{})})]})}function w({message:s}){return s.role==="assistant"?e.jsx(W,{content:s.content}):e.jsx(S,{content:s.content})}const{Storage:{default:C}}=b,{AI:{fetchPostPromotMessage:E}}=I,{User:{useUserLoginInfo:M}}=g;function L(){const{userId:s}=M(),{prompt:o,setPrompt:x,messages:i,chat:d}=v(s,C),[c,l]=n.useState(!1),r=n.useRef(null),{TextArea:p}=f,u=async t=>{if(!(t.keyCode===229||o.length<1||c)){l(!0);try{await d(E)}catch(a){j.error(a.message)}finally{l(!1)}}};return n.useLayoutEffect(()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},[i]),e.jsxs("div",{className:"ai-chat-page",children:[e.jsx("div",{className:"message-container",ref:r,children:i.map((t,a)=>e.jsx(w,{message:t},a))}),e.jsx(N,{}),e.jsx("div",{className:"edit-container",children:e.jsx(p,{value:o,disabled:c,maxLength:600,onChange:t=>{x(t.target.value)},onPressEnter:t=>u(t),placeholder:"请输入问题",style:{height:120,resize:"none"}})})]})}export{L as default};
