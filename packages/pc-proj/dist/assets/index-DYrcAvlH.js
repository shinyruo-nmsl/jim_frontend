import{r as m,bb as h,bc as f,bd as P}from"./index-7zKW46BM.js";import{a as d,U as A,b as I}from"./aiTextGener-BeKmR5ky.js";var M=(e=>(e.GetImages="/ai/images",e))(M||{});function v(e,r){const{historyMessages:o,saveMessages2LocalStore:p}=d(r,`__${e}_ai_gn_image_key__`),[l,a]=m.useState([...o]),[n,c]=m.useState({prompt:"",count:1});return{messages:l,prompt:n,setPrompt:c,getImages:async _=>{const i={type:"user",content:n.prompt};a(s=>[...s,i,{type:"assistant",content:[]}]),c({prompt:"",count:n.count});try{const{images:s}=await _(n),t={type:"assistant",content:s};a(g=>[...g.slice(0,g.length-1),t]),p([i,t])}catch(s){throw a(t=>[...t.slice(0,t.length-1),{type:"assistant",content:"抱歉，图片生成失败"}]),s}}}}var S=(e=>(e.ParseImage="/ai/parseImageContent",e))(S||{});function D(e,r){const{historyMessages:o,saveMessages2LocalStore:p}=d(r,`__${e}_ai_ps_image_key__`),[l,a]=m.useState([...o]),[n,c]=m.useState({imgUrl:"",description:""});return{prompt:n,setPrompt:c,messages:l,setMessages:a,chat:async _=>{const i={type:"user",content:n};a(s=>[...s,i,{type:"assistant",content:""}]),c({imgUrl:"",description:""});try{const s=await _(n);let t="";for await(const g of s)a(u=>{const y=u[u.length-1];return[...u.slice(0,u.length-1),{...y,content:y.content+g}]}),t=t+g;p([i,{type:"assistant",content:t}])}catch(s){a(t=>[...t.slice(0,t.length-1),{type:"assistant",content:s.message||"抱歉，回复失败"}])}}}}function U(e){return h(A.GetGPTContent,{messages:e})}function G(e){return h(S.ParseImage,{message:e})}function O(e){return f({method:"post",url:M.GetImages,data:{prompt:e}})}const L=Object.freeze(Object.defineProperty({__proto__:null,fetchGetAIImages:O,fetchGetAIParseMessage:G,fetchPostPromotMessage:U},Symbol.toStringTag,{value:"Module"}));function j(e){return f({method:"post",url:I.UPLOAD_BASE64_IMAGE,data:{...e}})}async function F(e){const{imgFile:r}=e,o=new FormData;return o.append("file",r),f({method:"post",url:I.UPLOAD_IMG_FILE,data:o,headers:{"Content-Type":"multipart/form-data",Accept:"*/*"}})}const w=Object.freeze(Object.defineProperty({__proto__:null,fetchUploadBase64Image:j,fetchUploadImgFile:F},Symbol.toStringTag,{value:"Module"})),E=Object.freeze(Object.defineProperty({__proto__:null,AI:L,File:w,User:P},Symbol.toStringTag,{value:"Module"}));export{S as U,E as W,D as a,v as u};
